{"version":3,"sources":["webpack://@flarum/tags/webpack/bootstrap","webpack://@flarum/tags/./forum.js","webpack://@flarum/tags/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@flarum/tags/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flarum/tags/./src/common/compat.js","webpack://@flarum/tags/./src/common/helpers/tagIcon.js","webpack://@flarum/tags/./src/common/helpers/tagLabel.js","webpack://@flarum/tags/./src/common/helpers/tagsLabel.js","webpack://@flarum/tags/./src/common/models/Tag.js","webpack://@flarum/tags/./src/common/utils/sortTags.js","webpack://@flarum/tags/./src/forum/addTagComposer.js","webpack://@flarum/tags/./src/forum/addTagControl.js","webpack://@flarum/tags/./src/forum/addTagFilter.js","webpack://@flarum/tags/./src/forum/addTagLabels.js","webpack://@flarum/tags/./src/forum/addTagList.js","webpack://@flarum/tags/./src/forum/compat.js","webpack://@flarum/tags/./src/forum/components/DiscussionTaggedPost.js","webpack://@flarum/tags/./src/forum/components/TagDiscussionModal.js","webpack://@flarum/tags/./src/forum/components/TagHero.js","webpack://@flarum/tags/./src/forum/components/TagLinkButton.js","webpack://@flarum/tags/./src/forum/components/TagsPage.js","webpack://@flarum/tags/./src/forum/index.js","webpack://@flarum/tags/external \"flarum.core\"","webpack://@flarum/tags/external \"flarum.core.compat['Component']\"","webpack://@flarum/tags/external \"flarum.core.compat['Model']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/Button']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/DiscussionComposer']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/DiscussionHero']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/DiscussionList']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/DiscussionListItem']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/EventPost']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/IndexPage']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/LinkButton']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/Modal']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/Page']\"","webpack://@flarum/tags/external \"flarum.core.compat['components/Separator']\"","webpack://@flarum/tags/external \"flarum.core.compat['extend']\"","webpack://@flarum/tags/external \"flarum.core.compat['helpers/highlight']\"","webpack://@flarum/tags/external \"flarum.core.compat['helpers/humanTime']\"","webpack://@flarum/tags/external \"flarum.core.compat['helpers/listItems']\"","webpack://@flarum/tags/external \"flarum.core.compat['models/Discussion']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/DiscussionControls']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/KeyboardNavigatable']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/classList']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/computed']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/extract']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/extractText']\"","webpack://@flarum/tags/external \"flarum.core.compat['utils/mixin']\""],"names":["sortTags","Tag","tagsLabel","tagIcon","tagLabel","tag","attrs","settings","hasIcon","icon","useColor","className","style","color","backgroundColor","link","extract","tagText","name","app","translator","trans","title","description","href","route","tags","slug","config","m","children","forEach","length","push","mixin","Model","attribute","backgroundUrl","backgroundMode","position","parent","hasOne","defaultSort","isChild","isHidden","discussionCount","lastPostedAt","transformDate","lastPostedDiscussion","isRestricted","canStartDiscussion","canAddToDiscussion","isPrimary","computed","slice","sort","a","b","aPos","bPos","aParent","bParent","extend","IndexPage","prototype","promise","store","getBy","params","then","component","DiscussionComposer","chooseTags","modal","show","TagDiscussionModal","selectedTags","onsubmit","$","focus","items","add","bind","override","original","chosenTags","chosenPrimaryTags","filter","chosenSecondaryTags","forum","data","relationships","DiscussionControls","discussion","canTag","Button","onclick","currentTag","TagHero","vdom","id","get","props","param","DiscussionList","include","q","DiscussionListItem","DiscussionPage","DiscussionHero","view","LinkButton","current","TagsPage","Separator","stickyParams","all","addTag","active","TagLinkButton","more","splice","compat","addTagFilter","addTagControl","DiscussionTaggedPost","addTagList","addTagLabels","addTagComposer","initProps","oldTags","post","content","newTags","diffTags","tags1","tags2","indexOf","map","getById","tagsAdded","tagsRemoved","descriptionKey","descriptionData","transChoice","count","EventPost","init","selected","prop","index","focused","minPrimary","maxPrimary","minSecondary","maxSecondary","navigator","KeyboardNavigatable","onUp","setIndex","getCurrentNumericIndex","onDown","onSelect","select","onRemove","primaryCount","secondaryCount","removeTag","getInstruction","remaining","toLowerCase","substr","onready","extractText","withAttr","navigate","type","disabled","classList","pinned","child","colored","toggleTag","highlight","e","metaKey","ctrlKey","submit","getItem","dispatchEvent","Event","selectableItems","scrollToItem","$items","$dropdown","$item","eq","attr","redraw","dropdownScroll","scrollTop","dropdownTop","offset","top","dropdownBottom","outerHeight","itemTop","itemBottom","parseInt","css","stop","animate","preventDefault","save","stream","update","close","strategy","Modal","Component","constructor","isActive","history","cloud","hero","affixSidebar","listItems","sidebarItems","toArray","element","isInitialized","on","stopPropagation","apply","arguments","lastPostNumber","humanTime","Page","initializers","routes","path","postComponents","discussionTagged","models","Discussion","hasMany","tagsCompat"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","/*\n * This file is part of Flarum.\n *\n * (c) Toby Zerner <toby.zerner@gmail.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nexport * from './src/common';\nexport * from './src/forum';\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import sortTags from './utils/sortTags';\nimport Tag from './models/Tag';\nimport tagsLabel from './helpers/tagsLabel';\nimport tagIcon from './helpers/tagIcon';\nimport tagLabel from './helpers/tagLabel';\n\nexport default {\n  'tags/utils/sortTags': sortTags,\n  'tags/models/Tag': Tag,\n  'tags/helpers/tagsLabel': tagsLabel,\n  'tags/helpers/tagIcon': tagIcon,\n  'tags/helpers/tagLabel': tagLabel\n};\n","export default function tagIcon(tag, attrs = {}, settings = {}) {\n  const hasIcon = tag && tag.icon();\n  const { useColor = true } = settings;\n\n  attrs.className = hasIcon ? 'icon ' + tag.icon() + ' ' + (attrs.className || '') : 'icon TagIcon ' + (attrs.className || '');\n\n  if (tag) {\n    attrs.style = attrs.style || {};\n\n    if (hasIcon) {\n      attrs.style.color = useColor ? tag.color() : '';\n    } else {\n      attrs.style.backgroundColor = tag.color();\n    }\n\n  } else {\n    attrs.className += ' untagged';\n  }\n\n  return hasIcon ? <i {...attrs}/> : <span {...attrs}/>;\n}\n","import extract from 'flarum/utils/extract';\nimport tagIcon from './tagIcon';\n\nexport default function tagLabel(tag, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'TagLabel ' + (attrs.className || '');\n\n  const link = extract(attrs, 'link');\n  const tagText = tag ? tag.name() : app.translator.trans('flarum-tags.lib.deleted_tag_text');\n\n  if (tag) {\n    const color = tag.color();\n    if (color) {\n      attrs.style.backgroundColor = attrs.style.color = color;\n      attrs.className += ' colored';\n    }\n\n    if (link) {\n      attrs.title = tag.description() || '';\n      attrs.href = app.route('tag', {tags: tag.slug()});\n      attrs.config = m.route;\n    }\n  } else {\n    attrs.className += ' untagged';\n  }\n\n  return (\n    m((link ? 'a' : 'span'), attrs,\n      <span className=\"TagLabel-text\">\n        {tag && tag.icon() && tagIcon(tag, {}, {useColor: false})} {tagText}\n      </span>\n    )\n  );\n}\n","import extract from 'flarum/utils/extract';\nimport tagLabel from './tagLabel';\nimport sortTags from '../utils/sortTags';\n\nexport default function tagsLabel(tags, attrs = {}) {\n  const children = [];\n  const link = extract(attrs, 'link');\n\n  attrs.className = 'TagsLabel ' + (attrs.className || '');\n\n  if (tags) {\n    sortTags(tags).forEach(tag => {\n      if (tag || tags.length === 1) {\n        children.push(tagLabel(tag, {link}));\n      }\n    });\n  } else {\n    children.push(tagLabel());\n  }\n\n  return <span {...attrs}>{children}</span>;\n}\n","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\nimport computed from 'flarum/utils/computed';\n\nexport default class Tag extends mixin(Model, {\n  name: Model.attribute('name'),\n  slug: Model.attribute('slug'),\n  description: Model.attribute('description'),\n\n  color: Model.attribute('color'),\n  backgroundUrl: Model.attribute('backgroundUrl'),\n  backgroundMode: Model.attribute('backgroundMode'),\n  icon: Model.attribute('icon'),\n\n  position: Model.attribute('position'),\n  parent: Model.hasOne('parent'),\n  defaultSort: Model.attribute('defaultSort'),\n  isChild: Model.attribute('isChild'),\n  isHidden: Model.attribute('isHidden'),\n\n  discussionCount: Model.attribute('discussionCount'),\n  lastPostedAt: Model.attribute('lastPostedAt', Model.transformDate),\n  lastPostedDiscussion: Model.hasOne('lastPostedDiscussion'),\n\n  isRestricted: Model.attribute('isRestricted'),\n  canStartDiscussion: Model.attribute('canStartDiscussion'),\n  canAddToDiscussion: Model.attribute('canAddToDiscussion'),\n\n  isPrimary: computed('position', 'parent', (position, parent) => position !== null && parent === false)\n}) {}\n","export default function sortTags(tags) {\n  return tags.slice(0).sort((a, b) => {\n    const aPos = a.position();\n    const bPos = b.position();\n\n    // If they're both secondary tags, sort them by their discussions count,\n    // descending.\n    if (aPos === null && bPos === null)\n      return b.discussionCount() - a.discussionCount();\n\n    // If just one is a secondary tag, then the primary tag should\n    // come first.\n    if (bPos === null) return -1;\n    if (aPos === null) return 1;\n\n    // If we've made it this far, we know they're both primary tags. So we'll\n    // need to see if they have parents.\n    const aParent = a.parent();\n    const bParent = b.parent();\n\n    // If they both have the same parent, then their positions are local,\n    // so we can compare them directly.\n    if (aParent === bParent) return aPos - bPos;\n\n    // If they are both child tags, then we will compare the positions of their\n    // parents.\n    else if (aParent && bParent)\n      return aParent.position() - bParent.position();\n\n    // If we are comparing a child tag with its parent, then we let the parent\n    // come first. If we are comparing an unrelated parent/child, then we\n    // compare both of the parents.\n    else if (aParent)\n      return aParent === b ? 1 : aParent.position() - bPos;\n\n    else if (bParent)\n      return bParent === a ? -1 : aPos - bParent.position();\n\n    return 0;\n  });\n}\n","import { extend, override } from 'flarum/extend';\nimport IndexPage from 'flarum/components/IndexPage';\nimport DiscussionComposer from 'flarum/components/DiscussionComposer';\n\nimport TagDiscussionModal from './components/TagDiscussionModal';\nimport tagsLabel from '../common/helpers/tagsLabel';\n\nexport default function() {\n  extend(IndexPage.prototype, 'newDiscussionAction', function(promise) {\n    const tag = app.store.getBy('tags', 'slug', this.params().tags);\n\n    if (tag) {\n      const parent = tag.parent();\n      const tags = parent ? [parent, tag] : [tag];\n      promise.then(component => component.tags = tags);\n    }\n  });\n\n  // Add tag-selection abilities to the discussion composer.\n  DiscussionComposer.prototype.tags = [];\n  DiscussionComposer.prototype.chooseTags = function() {\n    app.modal.show(\n      new TagDiscussionModal({\n        selectedTags: this.tags.slice(0),\n        onsubmit: tags => {\n          this.tags = tags;\n          this.$('textarea').focus();\n        }\n      })\n    );\n  };\n\n  // Add a tag-selection menu to the discussion composer's header, after the\n  // title.\n  extend(DiscussionComposer.prototype, 'headerItems', function(items) {\n    items.add('tags', (\n      <a className=\"DiscussionComposer-changeTags\" onclick={this.chooseTags.bind(this)}>\n        {this.tags.length\n          ? tagsLabel(this.tags)\n          : <span className=\"TagLabel untagged\">{app.translator.trans('flarum-tags.forum.composer_discussion.choose_tags_link')}</span>}\n      </a>\n    ), 10);\n  });\n\n  override(DiscussionComposer.prototype, 'onsubmit', function(original) {\n    const chosenTags = this.tags;\n    const chosenPrimaryTags = chosenTags.filter(tag => tag.position() !== null && !tag.isChild());\n    const chosenSecondaryTags = chosenTags.filter(tag => tag.position() === null);\n    if (!chosenTags.length\n      || (chosenPrimaryTags.length < app.forum.attribute('minPrimaryTags'))\n      || (chosenSecondaryTags.length < app.forum.attribute('minSecondaryTags'))) {\n      app.modal.show(\n        new TagDiscussionModal({\n          selectedTags: chosenTags,\n          onsubmit: tags => {\n            this.tags = tags;\n            original();\n          }\n        })\n      );\n    } else {\n      original();\n    }\n  });\n\n  // Add the selected tags as data to submit to the server.\n  extend(DiscussionComposer.prototype, 'data', function(data) {\n    data.relationships = data.relationships || {};\n    data.relationships.tags = this.tags;\n  });\n}\n","import { extend } from 'flarum/extend';\nimport DiscussionControls from 'flarum/utils/DiscussionControls';\nimport Button from 'flarum/components/Button';\n\nimport TagDiscussionModal from './components/TagDiscussionModal';\n\nexport default function() {\n  // Add a control allowing the discussion to be moved to another category.\n  extend(DiscussionControls, 'moderationControls', function(items, discussion) {\n    if (discussion.canTag()) {\n      items.add('tags', Button.component({\n        children: app.translator.trans('flarum-tags.forum.discussion_controls.edit_tags_button'),\n        icon: 'fas fa-tag',\n        onclick: () => app.modal.show(new TagDiscussionModal({discussion}))\n      }));\n    }\n  });\n}\n","import { extend, override } from 'flarum/extend';\nimport IndexPage from 'flarum/components/IndexPage';\nimport DiscussionList from 'flarum/components/DiscussionList';\n\nimport TagHero from './components/TagHero';\n\nexport default function() {\n  IndexPage.prototype.currentTag = function() {\n    const slug = this.params().tags;\n\n    if (slug) return app.store.getBy('tags', 'slug', slug);\n  };\n\n  // If currently viewing a tag, insert a tag hero at the top of the view.\n  override(IndexPage.prototype, 'hero', function(original) {\n    const tag = this.currentTag();\n\n    if (tag) return TagHero.component({tag});\n\n    return original();\n  });\n\n  extend(IndexPage.prototype, 'view', function(vdom) {\n    const tag = this.currentTag();\n\n    if (tag) {\n      vdom.attrs.className += ' IndexPage--tag'+tag.id();\n    }\n  });\n\n  // If currently viewing a tag, restyle the 'new discussion' button to use\n  // the tag's color.\n  extend(IndexPage.prototype, 'sidebarItems', function(items) {\n    const tag = this.currentTag();\n\n    if (tag) {\n      const color = tag.color();\n\n      if (color) {\n        items.get('newDiscussion').props.style = {backgroundColor: color};\n      }\n    }\n  });\n\n  // Add a parameter for the IndexPage to pass on to the DiscussionList that\n  // will let us filter discussions by tag.\n  extend(IndexPage.prototype, 'params', function(params) {\n    params.tags = m.route.param('tags');\n  });\n\n  // Translate that parameter into a gambit appended to the search query.\n  extend(DiscussionList.prototype, 'requestParams', function(params) {\n    params.include.push('tags');\n\n    if (this.props.params.tags) {\n      params.filter.q = (params.filter.q || '') + ' tag:' + this.props.params.tags;\n    }\n  });\n}\n","import { extend } from 'flarum/extend';\nimport DiscussionListItem from 'flarum/components/DiscussionListItem';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport DiscussionHero from 'flarum/components/DiscussionHero';\n\nimport tagsLabel from '../common/helpers/tagsLabel';\nimport sortTags from '../common/utils/sortTags';\n\nexport default function() {\n  // Add tag labels to each discussion in the discussion list.\n  extend(DiscussionListItem.prototype, 'infoItems', function(items) {\n    const tags = this.props.discussion.tags();\n\n    if (tags && tags.length) {\n      items.add('tags', tagsLabel(tags), 10);\n    }\n  });\n\n  // Include a discussion's tags when fetching it.\n  extend(DiscussionPage.prototype, 'params', function(params) {\n    params.include.push('tags');\n  });\n\n  // Restyle a discussion's hero to use its first tag's color.\n  extend(DiscussionHero.prototype, 'view', function(view) {\n    const tags = sortTags(this.props.discussion.tags());\n\n    if (tags && tags.length) {\n      const color = tags[0].color();\n      if (color) {\n        view.attrs.style = {backgroundColor: color};\n        view.attrs.className += ' DiscussionHero--colored';\n      }\n    }\n  });\n\n  // Add a list of a discussion's tags to the discussion hero, displayed\n  // before the title. Put the title on its own line.\n  extend(DiscussionHero.prototype, 'items', function(items) {\n    const tags = this.props.discussion.tags();\n\n    if (tags && tags.length) {\n      items.add('tags', tagsLabel(tags, {link: true}), 5);\n    }\n  });\n}\n","import { extend } from 'flarum/extend';\nimport IndexPage from 'flarum/components/IndexPage';\nimport Separator from 'flarum/components/Separator';\nimport LinkButton from 'flarum/components/LinkButton';\n\nimport TagLinkButton from './components/TagLinkButton';\nimport TagsPage from './components/TagsPage';\nimport sortTags from '../common/utils/sortTags';\n\nexport default function() {\n  // Add a link to the tags page, as well as a list of all the tags,\n  // to the index page's sidebar.\n  extend(IndexPage.prototype, 'navItems', function(items) {\n    items.add('tags', LinkButton.component({\n      icon: 'fas fa-th-large',\n      children: app.translator.trans('flarum-tags.forum.index.tags_link'),\n      href: app.route('tags')\n    }), -10);\n\n    if (app.current instanceof TagsPage) return;\n\n    items.add('separator', Separator.component(), -10);\n\n    const params = this.stickyParams();\n    const tags = app.store.all('tags');\n    const currentTag = this.currentTag();\n\n    const addTag = tag => {\n      let active = currentTag === tag;\n\n      if (!active && currentTag) {\n        active = currentTag.parent() === tag;\n      }\n\n      items.add('tag' + tag.id(), TagLinkButton.component({tag, params, active}), -10);\n    };\n\n    sortTags(tags)\n      .filter(tag => tag.position() !== null && (!tag.isChild() || (currentTag && (tag.parent() === currentTag || tag.parent() === currentTag.parent()))))\n      .forEach(addTag);\n\n    const more = tags\n      .filter(tag => tag.position() === null)\n      .sort((a, b) => b.discussionCount() - a.discussionCount());\n\n    more.splice(0, 3).forEach(addTag);\n\n    if (more.length) {\n      items.add('moreTags', LinkButton.component({\n        children: app.translator.trans('flarum-tags.forum.index.more_link'),\n        href: app.route('tags')\n      }), -10);\n    }\n  });\n}\n","import compat from '../common/compat';\n\nimport addTagFilter from './addTagFilter';\nimport addTagControl from './addTagControl';\nimport TagHero from './components/TagHero';\nimport TagDiscussionModal from './components/TagDiscussionModal';\nimport TagsPage from './components/TagsPage';\nimport DiscussionTaggedPost from './components/DiscussionTaggedPost';\nimport TagLinkButton from './components/TagLinkButton';\nimport addTagList from './addTagList';\nimport addTagLabels from './addTagLabels';\nimport addTagComposer from './addTagComposer';\n\nexport default Object.assign(compat, {\n  'tags/addTagFilter': addTagFilter,\n  'tags/addTagControl': addTagControl,\n  'tags/components/TagHero': TagHero,\n  'tags/components/TagDiscussionModal': TagDiscussionModal,\n  'tags/components/TagsPage': TagsPage,\n  'tags/components/DiscussionTaggedPost': DiscussionTaggedPost,\n  'tags/components/TagLinkButton': TagLinkButton,\n  'tags/addTagList': addTagList,\n  'tags/addTagLabels': addTagLabels,\n  'tags/addTagComposer': addTagComposer,\n});\n","import EventPost from 'flarum/components/EventPost';\nimport tagsLabel from '../../common/helpers/tagsLabel';\n\nexport default class DiscussionTaggedPost extends EventPost {\n  static initProps(props) {\n    super.initProps(props);\n\n    const oldTags = props.post.content()[0];\n    const newTags = props.post.content()[1];\n\n    function diffTags(tags1, tags2) {\n      return tags1\n        .filter(tag => tags2.indexOf(tag) === -1)\n        .map(id => app.store.getById('tags', id));\n    }\n\n    props.tagsAdded = diffTags(newTags, oldTags);\n    props.tagsRemoved = diffTags(oldTags, newTags);\n  }\n\n  icon() {\n    return 'fas fa-tag';\n  }\n\n  descriptionKey() {\n    if (this.props.tagsAdded.length) {\n      if (this.props.tagsRemoved.length) {\n        return 'flarum-tags.forum.post_stream.added_and_removed_tags_text';\n      }\n\n      return 'flarum-tags.forum.post_stream.added_tags_text';\n    }\n\n    return 'flarum-tags.forum.post_stream.removed_tags_text';\n  }\n\n  descriptionData() {\n    const data = {};\n\n    if (this.props.tagsAdded.length) {\n      data.tagsAdded = app.translator.transChoice('flarum-tags.forum.post_stream.tags_text', this.props.tagsAdded.length, {\n        tags: tagsLabel(this.props.tagsAdded, {link: true}),\n        count: this.props.tagsAdded.length\n      });\n    }\n\n    if (this.props.tagsRemoved.length) {\n      data.tagsRemoved = app.translator.transChoice('flarum-tags.forum.post_stream.tags_text', this.props.tagsRemoved.length, {\n        tags: tagsLabel(this.props.tagsRemoved, {link: true}),\n        count: this.props.tagsRemoved.length\n      });\n    }\n\n    return data;\n  }\n}\n","import Modal from 'flarum/components/Modal';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport Button from 'flarum/components/Button';\nimport highlight from 'flarum/helpers/highlight';\nimport classList from 'flarum/utils/classList';\nimport extractText from 'flarum/utils/extractText';\nimport KeyboardNavigatable from 'flarum/utils/KeyboardNavigatable';\n\nimport tagLabel from '../../common/helpers/tagLabel';\nimport tagIcon from '../../common/helpers/tagIcon';\nimport sortTags from '../../common/utils/sortTags';\n\nexport default class TagDiscussionModal extends Modal {\n  init() {\n    super.init();\n\n    this.tags = app.store.all('tags');\n\n    if (this.props.discussion) {\n      this.tags = this.tags.filter(tag => tag.canAddToDiscussion() || this.props.discussion.tags().indexOf(tag) !== -1);\n    } else {\n      this.tags = this.tags.filter(tag => tag.canStartDiscussion());\n    }\n\n    this.tags = sortTags(this.tags);\n\n    this.selected = [];\n    this.filter = m.prop('');\n    this.index = this.tags[0].id();\n    this.focused = false;\n\n    if (this.props.selectedTags) {\n      this.props.selectedTags.map(this.addTag.bind(this));\n    } else if (this.props.discussion) {\n      this.props.discussion.tags().map(this.addTag.bind(this));\n    }\n\n    this.minPrimary = app.forum.attribute('minPrimaryTags');\n    this.maxPrimary = app.forum.attribute('maxPrimaryTags');\n    this.minSecondary = app.forum.attribute('minSecondaryTags');\n    this.maxSecondary = app.forum.attribute('maxSecondaryTags');\n\n    this.navigator = new KeyboardNavigatable();\n    this.navigator\n      .onUp(() => this.setIndex(this.getCurrentNumericIndex() - 1, true))\n      .onDown(() => this.setIndex(this.getCurrentNumericIndex() + 1, true))\n      .onSelect(this.select.bind(this))\n      .onRemove(() => this.selected.splice(this.selected.length - 1, 1));\n  }\n\n  primaryCount() {\n    return this.selected.filter(tag => tag.isPrimary()).length;\n  }\n\n  secondaryCount() {\n    return this.selected.filter(tag => !tag.isPrimary()).length;\n  }\n\n  /**\n   * Add the given tag to the list of selected tags.\n   *\n   * @param {Tag} tag\n   */\n  addTag(tag) {\n    if (!tag.canStartDiscussion()) return;\n\n    // If this tag has a parent, we'll also need to add the parent tag to the\n    // selected list if it's not already in there.\n    const parent = tag.parent();\n    if (parent) {\n      const index = this.selected.indexOf(parent);\n      if (index === -1) {\n        this.selected.push(parent);\n      }\n    }\n\n    this.selected.push(tag);\n  }\n\n  /**\n   * Remove the given tag from the list of selected tags.\n   *\n   * @param {Tag} tag\n   */\n  removeTag(tag) {\n    const index = this.selected.indexOf(tag);\n    if (index !== -1) {\n      this.selected.splice(index, 1);\n\n      // Look through the list of selected tags for any tags which have the tag\n      // we just removed as their parent. We'll need to remove them too.\n      this.selected\n        .filter(selected => selected.parent() === tag)\n        .forEach(this.removeTag.bind(this));\n    }\n  }\n\n  className() {\n    return 'TagDiscussionModal';\n  }\n\n  title() {\n    return this.props.discussion\n      ? app.translator.trans('flarum-tags.forum.choose_tags.edit_title', {title: <em>{this.props.discussion.title()}</em>})\n      : app.translator.trans('flarum-tags.forum.choose_tags.title');\n  }\n\n  getInstruction(primaryCount, secondaryCount) {\n    if (primaryCount < this.minPrimary) {\n      const remaining = this.minPrimary - primaryCount;\n      return app.translator.transChoice('flarum-tags.forum.choose_tags.choose_primary_placeholder', remaining, {count: remaining});\n    } else if (secondaryCount < this.minSecondary) {\n      const remaining = this.minSecondary - secondaryCount;\n      return app.translator.transChoice('flarum-tags.forum.choose_tags.choose_secondary_placeholder', remaining, {count: remaining});\n    }\n\n    return '';\n  }\n\n  content() {\n    let tags = this.tags;\n    const filter = this.filter().toLowerCase();\n    const primaryCount = this.primaryCount();\n    const secondaryCount = this.secondaryCount();\n\n    // Filter out all child tags whose parents have not been selected. This\n    // makes it impossible to select a child if its parent hasn't been selected.\n    tags = tags.filter(tag => {\n      const parent = tag.parent();\n      return parent === false || this.selected.indexOf(parent) !== -1;\n    });\n\n    // If the number of selected primary/secondary tags is at the maximum, then\n    // we'll filter out all other tags of that type.\n    if (primaryCount >= this.maxPrimary) {\n      tags = tags.filter(tag => !tag.isPrimary() || this.selected.indexOf(tag) !== -1);\n    }\n\n    if (secondaryCount >= this.maxSecondary) {\n      tags = tags.filter(tag => tag.isPrimary() || this.selected.indexOf(tag) !== -1);\n    }\n\n    // If the user has entered text in the filter input, then filter by tags\n    // whose name matches what they've entered.\n    if (filter) {\n      tags = tags.filter(tag => tag.name().substr(0, filter.length).toLowerCase() === filter);\n    }\n\n    if (tags.indexOf(this.index) === -1) this.index = tags[0];\n\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"TagDiscussionModal-form\">\n          <div className=\"TagDiscussionModal-form-input\">\n            <div className={'TagsInput FormControl ' + (this.focused ? 'focus' : '')}>\n              <span className=\"TagsInput-selected\">\n                {this.selected.map(tag =>\n                  <span className=\"TagsInput-tag\" onclick={() => {\n                    this.removeTag(tag);\n                    this.onready();\n                  }}>\n                    {tagLabel(tag)}\n                  </span>\n                )}\n              </span>\n              <input className=\"FormControl\"\n                placeholder={extractText(this.getInstruction(primaryCount, secondaryCount))}\n                value={this.filter()}\n                oninput={m.withAttr('value', this.filter)}\n                onkeydown={this.navigator.navigate.bind(this.navigator)}\n                onfocus={() => this.focused = true}\n                onblur={() => this.focused = false}/>\n            </div>\n          </div>\n          <div className=\"TagDiscussionModal-form-submit App-primaryControl\">\n            {Button.component({\n              type: 'submit',\n              className: 'Button Button--primary',\n              disabled: primaryCount < this.minPrimary || secondaryCount < this.minSecondary,\n              icon: 'fas fa-check',\n              children: app.translator.trans('flarum-tags.forum.choose_tags.submit_button')\n            })}\n          </div>\n        </div>\n      </div>,\n\n      <div className=\"Modal-footer\">\n        <ul className=\"TagDiscussionModal-list SelectTagList\">\n          {tags\n            .filter(tag => filter || !tag.parent() || this.selected.indexOf(tag.parent()) !== -1)\n            .map(tag => (\n              <li data-index={tag.id()}\n                className={classList({\n                  pinned: tag.position() !== null,\n                  child: !!tag.parent(),\n                  colored: !!tag.color(),\n                  selected: this.selected.indexOf(tag) !== -1,\n                  active: this.index === tag\n                })}\n                style={{color: tag.color()}}\n                onmouseover={() => this.index = tag}\n                onclick={this.toggleTag.bind(this, tag)}\n              >\n                {tagIcon(tag)}\n                <span className=\"SelectTagListItem-name\">\n                  {highlight(tag.name(), filter)}\n                </span>\n                {tag.description()\n                  ? (\n                    <span className=\"SelectTagListItem-description\">\n                      {tag.description()}\n                    </span>\n                  ) : ''}\n              </li>\n            ))}\n        </ul>\n      </div>\n    ];\n  }\n\n  toggleTag(tag) {\n    const index = this.selected.indexOf(tag);\n\n    if (index !== -1) {\n      this.removeTag(tag);\n    } else {\n      this.addTag(tag);\n    }\n\n    if (this.filter()) {\n      this.filter('');\n      this.index = this.tags[0];\n    }\n\n    this.onready();\n  }\n\n  select(e) {\n    // Ctrl + Enter submits the selection, just Enter completes the current entry\n    if (e.metaKey || e.ctrlKey || this.selected.indexOf(this.index) !== -1) {\n      if (this.selected.length) {\n        this.$('form').submit();\n      }\n    } else {\n      this.getItem(this.index)[0].dispatchEvent(new Event('click'));\n    }\n  }\n\n  selectableItems() {\n    return this.$('.TagDiscussionModal-list > li');\n  }\n\n  getCurrentNumericIndex() {\n    return this.selectableItems().index(\n      this.getItem(this.index)\n    );\n  }\n\n  getItem(index) {\n    return this.selectableItems().filter(`[data-index=\"${index.id()}\"]`);\n  }\n\n  setIndex(index, scrollToItem) {\n    const $items = this.selectableItems();\n    const $dropdown = $items.parent();\n\n    if (index < 0) {\n      index = $items.length - 1;\n    } else if (index >= $items.length) {\n      index = 0;\n    }\n\n    const $item = $items.eq(index);\n\n    this.index = app.store.getById('tags', $item.attr('data-index'));\n\n    m.redraw();\n\n    if (scrollToItem) {\n      const dropdownScroll = $dropdown.scrollTop();\n      const dropdownTop = $dropdown.offset().top;\n      const dropdownBottom = dropdownTop + $dropdown.outerHeight();\n      const itemTop = $item.offset().top;\n      const itemBottom = itemTop + $item.outerHeight();\n\n      let scrollTop;\n      if (itemTop < dropdownTop) {\n        scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n      } else if (itemBottom > dropdownBottom) {\n        scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n      }\n\n      if (typeof scrollTop !== 'undefined') {\n        $dropdown.stop(true).animate({scrollTop}, 100);\n      }\n    }\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    const discussion = this.props.discussion;\n    const tags = this.selected;\n\n    if (discussion) {\n      discussion.save({relationships: {tags}})\n        .then(() => {\n          if (app.current instanceof DiscussionPage) {\n            app.current.stream.update();\n          }\n          m.redraw();\n        });\n    }\n\n    if (this.props.onsubmit) this.props.onsubmit(tags);\n\n    app.modal.close();\n\n    m.redraw.strategy('none');\n  }\n}\n","import Component from 'flarum/Component';\nimport tagIcon from '../../common/helpers/tagIcon';\n\nexport default class TagHero extends Component {\n  view() {\n    const tag = this.props.tag;\n    const color = tag.color();\n\n    return (\n      <header className={'Hero TagHero' + (color ? ' TagHero--colored' : '')}\n        style={color ? {color: '#fff', backgroundColor: color} : ''}>\n        <div className=\"container\">\n          <div className=\"containerNarrow\">\n            <h2 className=\"Hero-title\">{tag.icon() && tagIcon(tag, {}, { useColor: false })} {tag.name()}</h2>\n            <div className=\"Hero-subtitle\">{tag.description()}</div>\n          </div>\n        </div>\n      </header>\n    );\n  }\n}\n","import LinkButton from 'flarum/components/LinkButton';\nimport tagIcon from '../../common/helpers/tagIcon';\n\nexport default class TagLinkButton extends LinkButton {\n  view() {\n    const tag = this.props.tag;\n    const active = this.constructor.isActive(this.props);\n    const description = tag && tag.description();\n\n    return (\n      <a className={'TagLinkButton hasIcon ' + (tag.isChild() ? 'child' : '')} href={this.props.href} config={m.route}\n        style={active && tag ? {color: tag.color()} : ''}\n        title={description || ''}>\n        {tagIcon(tag, {className: 'Button-icon'})}\n        {this.props.children}\n      </a>\n    );\n  }\n\n  static initProps(props) {\n    const tag = props.tag;\n\n    props.params.tags = tag ? tag.slug() : 'untagged';\n    props.href = app.route('tag', props.params);\n    props.children = tag ? tag.name() : app.translator.trans('flarum-tags.forum.index.untagged_link');\n  }\n}\n","import Page from 'flarum/components/Page';\nimport IndexPage from 'flarum/components/IndexPage';\nimport listItems from 'flarum/helpers/listItems';\nimport humanTime from 'flarum/helpers/humanTime';\n\nimport tagLabel from '../../common/helpers/tagLabel';\nimport sortTags from '../../common/utils/sortTags';\n\nexport default class TagsPage extends Page {\n  init() {\n    super.init();\n\n    this.tags = sortTags(app.store.all('tags').filter(tag => !tag.parent()));\n\n    app.history.push('tags', app.translator.trans('flarum-tags.forum.header.back_to_tags_tooltip'));\n  }\n\n  view() {\n    const pinned = this.tags.filter(tag => tag.position() !== null);\n    const cloud = this.tags.filter(tag => tag.position() === null);\n\n    return (\n      <div className=\"TagsPage\">\n        {IndexPage.prototype.hero()}\n        <div className=\"container\">\n          <nav className=\"TagsPage-nav IndexPage-nav sideNav\" config={IndexPage.prototype.affixSidebar}>\n            <ul>{listItems(IndexPage.prototype.sidebarItems().toArray())}</ul>\n          </nav>\n\n          <div className=\"TagsPage-content sideNavOffset\">\n            <ul className=\"TagTiles\">\n              {pinned.map(tag => {\n                const lastPostedDiscussion = tag.lastPostedDiscussion();\n                const children = sortTags(app.store.all('tags').filter(child => child.parent() === tag));\n\n                return (\n                  <li className={'TagTile ' + (tag.color() ? 'colored' : '')}\n                    style={{backgroundColor: tag.color()}}>\n                    <a className=\"TagTile-info\" href={app.route.tag(tag)} config={m.route}>\n                      <h3 className=\"TagTile-name\">{tag.name()}</h3>\n                      <p className=\"TagTile-description\">{tag.description()}</p>\n                      {children\n                        ? (\n                          <div className=\"TagTile-children\">\n                            {children.map(child => [\n                              <a href={app.route.tag(child)} config={function(element, isInitialized) {\n                                if (isInitialized) return;\n                                $(element).on('click', e => e.stopPropagation());\n                                m.route.apply(this, arguments);\n                              }}>\n                                {child.name()}\n                              </a>,\n                              ' '\n                            ])}\n                          </div>\n                        ) : ''}\n                    </a>\n                    {lastPostedDiscussion\n                      ? (\n                        <a className=\"TagTile-lastPostedDiscussion\"\n                          href={app.route.discussion(lastPostedDiscussion, lastPostedDiscussion.lastPostNumber())}\n                          config={m.route}>\n                          <span className=\"TagTile-lastPostedDiscussion-title\">{lastPostedDiscussion.title()}</span>\n                          {humanTime(lastPostedDiscussion.lastPostedAt())}\n                        </a>\n                      ) : (\n                        <span className=\"TagTile-lastPostedDiscussion\"/>\n                      )}\n                  </li>\n                );\n              })}\n            </ul>\n\n            {cloud.length ? (\n              <div className=\"TagCloud\">\n                {cloud.map(tag => [\n                  tagLabel(tag, {link: true}),\n                  ' ',\n                ])}\n              </div>\n            ) : ''}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import Model from 'flarum/Model';\nimport Discussion from 'flarum/models/Discussion';\nimport IndexPage from 'flarum/components/IndexPage';\n\nimport Tag from '../common/models/Tag';\nimport TagsPage from './components/TagsPage';\nimport DiscussionTaggedPost from './components/DiscussionTaggedPost';\n\nimport addTagList from './addTagList';\nimport addTagFilter from './addTagFilter';\nimport addTagLabels from './addTagLabels';\nimport addTagControl from './addTagControl';\nimport addTagComposer from './addTagComposer';\n\napp.initializers.add('flarum-tags', function(app) {\n  app.routes.tags = {path: '/tags', component: TagsPage.component()};\n  app.routes.tag = {path: '/t/:tags', component: IndexPage.component()};\n\n  app.route.tag = tag => app.route('tag', {tags: tag.slug()});\n\n  app.postComponents.discussionTagged = DiscussionTaggedPost;\n\n  app.store.models.tags = Tag;\n\n  Discussion.prototype.tags = Model.hasMany('tags');\n  Discussion.prototype.canTag = Model.attribute('canTag');\n\n  addTagList();\n  addTagFilter();\n  addTagLabels();\n  addTagControl();\n  addTagComposer();\n});\n\n\n// Expose compat API\nimport tagsCompat from './compat';\nimport { compat } from '@flarum/core/forum';\n\nObject.assign(compat, tagsCompat);","module.exports = flarum.core;","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/DiscussionComposer'];","module.exports = flarum.core.compat['components/DiscussionHero'];","module.exports = flarum.core.compat['components/DiscussionList'];","module.exports = flarum.core.compat['components/DiscussionListItem'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/EventPost'];","module.exports = flarum.core.compat['components/IndexPage'];","module.exports = flarum.core.compat['components/LinkButton'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/Separator'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/highlight'];","module.exports = flarum.core.compat['helpers/humanTime'];","module.exports = flarum.core.compat['helpers/listItems'];","module.exports = flarum.core.compat['models/Discussion'];","module.exports = flarum.core.compat['utils/DiscussionControls'];","module.exports = flarum.core.compat['utils/KeyboardNavigatable'];","module.exports = flarum.core.compat['utils/classList'];","module.exports = flarum.core.compat['utils/computed'];","module.exports = flarum.core.compat['utils/extract'];","module.exports = flarum.core.compat['utils/extractText'];","module.exports = flarum.core.compat['utils/mixin'];"],"sourceRoot":""}